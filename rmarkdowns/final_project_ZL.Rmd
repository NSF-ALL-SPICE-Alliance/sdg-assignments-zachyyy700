# Zach's Final Project for the United Nations Sustainable Development Goals

```{r}
library(tidyverse)
library(rnaturalearth)
library(here)
library(janitor)
library(plotly)
library(leaflet)
library(sf)
library(ggplot2)
```

Country/SDG of focus: SDG 7 - Affordable and Clean Energy

```{r}
#load in sdr data and clean
sdr_data <- read_csv(here("data/SDR-2023-Data.csv"))

sdr_data <- sdr_data %>%
  clean_names()
```

### Global Distribution Map of SDG 7

```{r}
#using setup techniques learned in advanced viz lesson
world <- ne_countries(scale = "medium", returnclass = "sf")

world <- world %>%
  select(name_long, iso_a3, geometry)

colnames(sdr_data)[which(colnames(sdr_data) == "country_code_iso3")] <- "iso_a3"

#combine dataframes
sdr_data_world_joined <- left_join(sdr_data, world, by = "iso_a3")

#convert to sf dataframe
sdr_data_world_joined <- st_as_sf(sdr_data_world_joined)

#specify crs
sdr_data_world_joined <- st_transform(sdr_data_world_joined, "+proj=longlat +datum=WGS84")

```

```{r}
#plot sdg7 map
mytext <- paste(
    "Country: ", sdr_data_world_joined$country,"<br/>", 
    "Goal 7 Score: ", round(sdr_data_world_joined$goal_7_score, 2), 
    sep="") %>%
  lapply(htmltools::HTML)

leaflet(sdr_data_world_joined) %>% 
  addTiles()  %>% 
  setView(lat=10, lng=0 , zoom=2) %>%
  addPolygons(stroke = FALSE, fillOpacity = 0.5, smoothFactor = 0.5, color = ~colorQuantile("PRGn", goal_7_score)(goal_7_score), label = mytext)
 
```

This is a map displaying the distribution of SDG 7 scores. High SDG 7 scores are indicated in dark green while low SDG 7 scores are indicated by dark purple. Off the bat, it seems like the map is split into two parts. The majority of the left side is green with a handful of purple outliers, this part includes Europe as well. The opposite is true for the right side of the map, including Africa. 


I want to see the top and bottom 5 for this score.
```{r}
top_5 <- sdr_data[order(-sdr_data$goal_7_score), ][1:5, ]

bottom_5 <- sdr_data[order(sdr_data$goal_7_score), ][1:5, ]

ggplot(top_5, aes(y = reorder(country, goal_7_score), x = goal_7_score)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 SDG 7 Countries",
       x = "SDG 7 Score",
       y = "Country")
  theme_minimal()
  
ggplot(bottom_5, aes(y = reorder(country, -goal_7_score), x = goal_7_score)) +
  geom_bar(stat = "identity") +
  labs(title = "Bottom 5 SDG 7 Countries",
       x = "SDG 7 Score",
       y = "Country")
```

